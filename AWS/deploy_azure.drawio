<?xml version='1.0' encoding='utf-8'?>
<mxGraphModel>
  <root>
    <mxCell id="0" />
    <mxCell id="1" parent="0" />
    <mxCell id="edge" value="Public Edge" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#2196F3;" vertex="1" parent="1">
      <mxGeometry x="20" y="20" width="280" height="240" as="geometry" />
    </mxCell>
    <mxCell id="region" value="Azure Region / VNet" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8F5E9;strokeColor=#43A047;" vertex="1" parent="1">
      <mxGeometry x="340" y="20" width="780" height="560" as="geometry" />
    </mxCell>
    <mxCell id="ingress" value="Ingress Subnet" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFDE7;strokeColor=#FBC02D;" vertex="1" parent="region">
      <mxGeometry x="360" y="40" width="360" height="240" as="geometry" />
    </mxCell>
    <mxCell id="processing" value="Processing Subnet" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFDE7;strokeColor=#FBC02D;" vertex="1" parent="region">
      <mxGeometry x="720" y="40" width="380" height="240" as="geometry" />
    </mxCell>
    <mxCell id="data" value="Data Subnet" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFDE7;strokeColor=#FBC02D;" vertex="1" parent="region">
      <mxGeometry x="360" y="300" width="360" height="260" as="geometry" />
    </mxCell>
    <mxCell id="ml" value="ML/Analytics Subnet" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFDE7;strokeColor=#FBC02D;" vertex="1" parent="region">
      <mxGeometry x="720" y="300" width="380" height="160" as="geometry" />
    </mxCell>
    <mxCell id="ops" value="Ops/Observability" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFDE7;strokeColor=#FBC02D;" vertex="1" parent="region">
      <mxGeometry x="720" y="470" width="380" height="90" as="geometry" />
    </mxCell>
    <mxCell id="fd" value="Azure Front Door" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="edge">
      <mxGeometry x="40" y="60" width="240" height="40" as="geometry" />
    </mxCell>
    <mxCell id="apim" value="API Management" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="edge">
      <mxGeometry x="40" y="110" width="240" height="40" as="geometry" />
    </mxCell>
    <mxCell id="notify" value="Notification Hubs" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="edge">
      <mxGeometry x="40" y="160" width="240" height="40" as="geometry" />
    </mxCell>
    <mxCell id="device" value="Device (IoT)" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
      <mxGeometry x="40" y="210" width="240" height="40" as="geometry" />
    </mxCell>
    <mxCell id="pe" value="Private Endpoint" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="ingress">
      <mxGeometry x="380" y="60" width="160" height="40" as="geometry" />
    </mxCell>
    <mxCell id="iothub" value="Azure IoT Hub" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="ingress">
      <mxGeometry x="560" y="60" width="140" height="40" as="geometry" />
    </mxCell>
    <mxCell id="eventhubs" value="Event Hubs" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="ingress">
      <mxGeometry x="380" y="120" width="320" height="40" as="geometry" />
    </mxCell>
    <mxCell id="func" value="Azure Functions (Premium)" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="processing">
      <mxGeometry x="740" y="60" width="340" height="40" as="geometry" />
    </mxCell>
    <mxCell id="ca" value="Azure Container Apps (Feature Extraction)" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="processing">
      <mxGeometry x="740" y="110" width="340" height="40" as="geometry" />
    </mxCell>
    <mxCell id="asa" value="Azure Stream Analytics" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="processing">
      <mxGeometry x="740" y="160" width="340" height="40" as="geometry" />
    </mxCell>
    <mxCell id="eg" value="Event Grid / Logic Apps (Alerts)" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="processing">
      <mxGeometry x="740" y="210" width="340" height="40" as="geometry" />
    </mxCell>
    <mxCell id="blob" value="Blob Storage (hot/cool/archive)" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="data">
      <mxGeometry x="380" y="320" width="320" height="40" as="geometry" />
    </mxCell>
    <mxCell id="adls" value="Data Lake Gen2" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="data">
      <mxGeometry x="380" y="370" width="320" height="40" as="geometry" />
    </mxCell>
    <mxCell id="cosmos" value="Cosmos DB (metadata/queries)" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="data">
      <mxGeometry x="380" y="420" width="320" height="40" as="geometry" />
    </mxCell>
    <mxCell id="kv" value="Key Vault" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="data">
      <mxGeometry x="380" y="470" width="320" height="40" as="geometry" />
    </mxCell>
    <mxCell id="aml" value="Azure ML (Model Registry/Training)" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="ml">
      <mxGeometry x="740" y="320" width="340" height="40" as="geometry" />
    </mxCell>
    <mxCell id="mon" value="Azure Monitor" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="ops">
      <mxGeometry x="740" y="490" width="160" height="40" as="geometry" />
    </mxCell>
    <mxCell id="logs" value="Log Analytics" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="ops">
      <mxGeometry x="920" y="490" width="160" height="40" as="geometry" />
    </mxCell>
    <mxCell id="e1" value="mTLS MQTT/HTTP" style="edgeStyle=orthogonalEdgeStyle;rounded=1;html=1;endArrow=block;endFill=1;" edge="1" parent="1" source="device" target="pe">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>
    <mxCell id="e2" value="private link" style="edgeStyle=orthogonalEdgeStyle;rounded=1;html=1;endArrow=block;endFill=1;" edge="1" parent="1" source="pe" target="iothub">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>
    <mxCell id="e3" value="routes" style="edgeStyle=orthogonalEdgeStyle;rounded=1;html=1;endArrow=block;endFill=1;" edge="1" parent="1" source="iothub" target="eventhubs">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>
    <mxCell id="e4" value="events" style="edgeStyle=orthogonalEdgeStyle;rounded=1;html=1;endArrow=block;endFill=1;" edge="1" parent="1" source="eventhubs" target="func">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>
    <mxCell id="e5" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;html=1;endArrow=block;endFill=1;" edge="1" parent="1" source="func" target="ca">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>
    <mxCell id="e6" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;html=1;endArrow=block;endFill=1;" edge="1" parent="1" source="func" target="asa">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>
    <mxCell id="e7" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;html=1;endArrow=block;endFill=1;" edge="1" parent="1" source="func" target="blob">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>
    <mxCell id="e8" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;html=1;endArrow=block;endFill=1;" edge="1" parent="1" source="func" target="cosmos">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>
    <mxCell id="e9" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=1;html=1;endArrow=block;endFill=1;" edge="1" parent="1" source="ca" target="aml">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>
    <mxCell id="e10" value="model events" style="edgeStyle=orthogonalEdgeStyle;rounded=1;html=1;endArrow=block;endFill=1;" edge="1" parent="1" source="aml" target="eg">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>
    <mxCell id="e11" value="detections" style="edgeStyle=orthogonalEdgeStyle;rounded=1;html=1;endArrow=block;endFill=1;" edge="1" parent="1" source="asa" target="eg">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>
    <mxCell id="e12" value="alerts" style="edgeStyle=orthogonalEdgeStyle;rounded=1;html=1;endArrow=block;endFill=1;" edge="1" parent="1" source="eg" target="notify">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>
    <mxCell id="e13" value="queries" style="edgeStyle=orthogonalEdgeStyle;rounded=1;html=1;endArrow=block;endFill=1;" edge="1" parent="1" source="cosmos" target="apim">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>
    <mxCell id="e14" value="public ingress" style="edgeStyle=orthogonalEdgeStyle;rounded=1;html=1;endArrow=block;endFill=1;" edge="1" parent="1" source="apim" target="fd">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>
    <mxCell id="e15" value="secrets" style="edgeStyle=orthogonalEdgeStyle;rounded=1;html=1;endArrow=block;endFill=1;" edge="1" parent="1" source="func" target="kv">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>
    <mxCell id="e16" value="secrets" style="edgeStyle=orthogonalEdgeStyle;rounded=1;html=1;endArrow=block;endFill=1;" edge="1" parent="1" source="ca" target="kv">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>
    <mxCell id="e17" value="metrics" style="edgeStyle=orthogonalEdgeStyle;rounded=1;html=1;endArrow=block;endFill=1;" edge="1" parent="1" source="blob" target="mon">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>
    <mxCell id="e18" value="logs" style="edgeStyle=orthogonalEdgeStyle;rounded=1;html=1;endArrow=block;endFill=1;" edge="1" parent="1" source="eventhubs" target="logs">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>
    <mxCell id="e19" value="logs" style="edgeStyle=orthogonalEdgeStyle;rounded=1;html=1;endArrow=block;endFill=1;" edge="1" parent="1" source="func" target="logs">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>
  </root>
</mxGraphModel>